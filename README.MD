# PHP REST API com JWT e MySQL

![PHP](https://img.shields.io/badge/PHP-8.0%2B-blue)
![MySQL](https://img.shields.io/badge/MySQL-5.7%2B-orange)
![JWT](https://img.shields.io/badge/JWT-Authentication-green)
![REST](https://img.shields.io/badge/REST-API-yellow)

Uma API REST elegante e poderosa construÃ­da com PHP puro, utilizando autenticaÃ§Ã£o JWT e banco de dados MySQL. Este projeto implementa um CRUD completo seguindo boas prÃ¡ticas de desenvolvimento.

## ğŸš€ Funcionalidades

- âœ… Sistema de autenticaÃ§Ã£o com JWT
- âœ… OperaÃ§Ãµes CRUD para usuÃ¡rios
- âœ… Arquitetura organizada e escalÃ¡vel
- âœ… Middleware de autenticaÃ§Ã£o
- âœ… ValidaÃ§Ã£o de dados
- âœ… Gerenciamento de erros

## ğŸ“š Estrutura do Projeto

```
projeto-api/
â”œâ”€â”€ .htaccess                # ConfiguraÃ§Ãµes de rewrite para URLs amigÃ¡veis
â”œâ”€â”€ composer.json            # DependÃªncias do projeto
â”œâ”€â”€ index.php                # Ponto de entrada da aplicaÃ§Ã£o e router
â”œâ”€â”€ config/
â”‚   â””â”€â”€ Database.php         # ConfiguraÃ§Ã£o da conexÃ£o com o banco de dados
â”œâ”€â”€ controllers/
â”‚   â”œâ”€â”€ AuthController.php   # Controlador para autenticaÃ§Ã£o
â”‚   â””â”€â”€ UserController.php   # Controlador para operaÃ§Ãµes de usuÃ¡rios
â”œâ”€â”€ models/
â”‚   â””â”€â”€ User.php             # Modelo de dados de usuÃ¡rio
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ JwtHandler.php       # Classe para gerenciamento de JWT
â””â”€â”€ middleware/
    â””â”€â”€ AuthMiddleware.php   # Middleware para verificaÃ§Ã£o de autenticaÃ§Ã£o
```

## ğŸ“‹ PrÃ©-requisitos

- PHP 8.0 ou superior
- MySQL 5.7 ou superior
- Composer
- Servidor web (Apache ou Nginx)

## âš™ï¸ InstalaÃ§Ã£o

### 1. Clone o repositÃ³rio
```bash
git clone https://github.com/seu-usuario/projeto-api.git
cd projeto-api
```

### 2. Instale as dependÃªncias
```bash
composer install
```

### 3. ConfiguraÃ§Ã£o do banco de dados
Edite o arquivo `config/Database.php` com suas credenciais:

```php
private $host = "localhost";
private $database_name = "api_db";
private $username = "seu_usuario";
private $password = "sua_senha";
```

### 4. CriaÃ§Ã£o do banco de dados
```sql
CREATE DATABASE api_db;
USE api_db;

CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    email VARCHAR(100) NOT NULL UNIQUE,
    password VARCHAR(255) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

### 5. ConfiguraÃ§Ã£o do servidor web
Para Apache, certifique-se de que o arquivo `.htaccess` esteja na raiz do projeto.

Para Nginx, adicione a seguinte configuraÃ§Ã£o:
```nginx
location / {
    try_files $uri $uri/ /index.php?$query_string;
}
```

## ğŸ”’ ConfiguraÃ§Ã£o de SeguranÃ§a

Edite o arquivo `utils/JwtHandler.php` e altere a chave secreta:

```php
private $secretKey = "sua_chave_secreta_muito_segura";
```

**Importante:** Em ambiente de produÃ§Ã£o, mova esta chave para uma variÃ¡vel de ambiente.

## ğŸš€ Uso da API

### AutenticaÃ§Ã£o

#### Registro
```http
POST /auth/register
Content-Type: application/json

{
  "name": "UsuÃ¡rio Teste",
  "email": "usuario@teste.com",
  "password": "senha123"
}
```

#### Login
```http
POST /auth/login
Content-Type: application/json

{
  "email": "usuario@teste.com",
  "password": "senha123"
}
```

Resposta (exemplo):
```json
{
  "status": 1,
  "message": "Login realizado com sucesso",
  "token": "eyJ0eXAiOiJKV...",
  "user": {
    "id": 1,
    "name": "UsuÃ¡rio Teste",
    "email": "usuario@teste.com"
  }
}
```

### Endpoints de UsuÃ¡rios

**Nota:** Todos os endpoints abaixo requerem autenticaÃ§Ã£o. Adicione o header:
```
Authorization: Bearer {seu_token_jwt}
```

#### Listar todos os usuÃ¡rios
```http
GET /users
```

#### Obter usuÃ¡rio por ID
```http
GET /users/{id}
```

#### Criar novo usuÃ¡rio
```http
POST /users
Content-Type: application/json

{
  "name": "Novo UsuÃ¡rio",
  "email": "novo@usuario.com",
  "password": "senha456"
}
```

#### Atualizar usuÃ¡rio
```http
PUT /users/{id}
Content-Type: application/json

{
  "name": "Nome Atualizado",
  "email": "email@atualizado.com"
}
```

#### Excluir usuÃ¡rio
```http
DELETE /users/{id}
```

## ğŸ“ Notas importantes

1. A API implementa verificaÃ§Ã£o de permissÃµes bÃ¡sica: usuÃ¡rios sÃ³ podem atualizar ou excluir seus prÃ³prios dados.
2. Para aumentar a seguranÃ§a, considere:
   - Implementar limitaÃ§Ã£o de taxa (rate limiting)
   - Usar HTTPS em produÃ§Ã£o
   - Adicionar validaÃ§Ã£o mais robusta dos dados de entrada
   - Implementar sistema de logs

## ğŸ› ï¸ PersonalizaÃ§Ãµes

### Adicionar novos recursos

Para adicionar um novo recurso (por exemplo, "produtos"):

1. Crie uma nova tabela no banco de dados
2. Crie um modelo em `models/Product.php`
3. Crie um controlador em `controllers/ProductController.php`
4. Adicione as rotas em `index.php`

### Alterar tempo de expiraÃ§Ã£o do token

Edite a linha a seguir em `utils/JwtHandler.php`:

```php
$this->expiry = $this->issuedAt + 3600; // Token vÃ¡lido por 1 hora
```

## ğŸ”„ Fluxo de autenticaÃ§Ã£o

1. O usuÃ¡rio envia credenciais (email/senha)
2. O sistema verifica as credenciais no banco de dados
3. Se vÃ¡lidas, gera um token JWT contendo o ID do usuÃ¡rio
4. O token Ã© retornado ao usuÃ¡rio
5. O usuÃ¡rio inclui o token nos headers das requisiÃ§Ãµes subsequentes
6. O middleware valida o token antes de permitir acesso aos endpoints protegidos

## ğŸ¤ ContribuiÃ§Ãµes

ContribuiÃ§Ãµes sÃ£o bem-vindas! Sinta-se Ã  vontade para abrir issues ou enviar pull requests.

## ğŸ“œ LicenÃ§a

Este projeto estÃ¡ licenciado sob a licenÃ§a MIT - veja o arquivo LICENSE para detalhes.
